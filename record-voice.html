<!DOCTYPE html>
<html>
<head>
    <title>Voice Recorder for Testing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            text-align: center;
        }
        button {
            padding: 15px 30px;
            font-size: 16px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .record { background-color: #ff4444; color: white; }
        .stop { background-color: #44ff44; color: white; }
        .play { background-color: #4444ff; color: white; }
        .download { background-color: #ff8800; color: white; }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            background-color: #f0f0f0;
        }
        .recording { background-color: #ffeeee; }
        audio {
            width: 100%;
            margin: 20px 0;
        }
        .timer {
            font-size: 24px;
            font-weight: bold;
            color: #ff4444;
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1>üé§ Voice Recorder for ElevenLabs Cloning</h1>
    <p>Record your voice to create a voice clone. <strong>Recommended: 1-3 minutes minimum.</strong></p>

    <div class="status" id="status">Click "Start Recording" to begin</div>
    <div class="timer" id="timer">00:00</div>

    <button id="startBtn" class="record">üé§ Start Recording</button>
    <button id="stopBtn" class="stop" disabled>‚èπÔ∏è Stop Recording</button>
    <button id="playBtn" class="play" disabled>‚ñ∂Ô∏è Play</button>
    <button id="downloadBtn" class="download" disabled>üíæ Download WAV</button>

    <audio id="audioPlayer" controls style="display: none;"></audio>

    <div style="margin-top: 30px; text-align: left; background: #f5f5f5; padding: 15px; border-radius: 5px;">
        <h3>üí° Tips for Quality Recording:</h3>
        <ul>
            <li><strong>Duration:</strong> Record for 1-3 minutes minimum (ElevenLabs requirement)</li>
            <li><strong>Quality:</strong> Use a good microphone if available</li>
            <li><strong>Environment:</strong> Record in a quiet room without echo</li>
            <li><strong>Speech:</strong> Speak clearly and naturally</li>
            <li><strong>Content:</strong> Read varied sentences with different emotions</li>
            <li><strong>Volume:</strong> Speak at normal conversation level</li>
        </ul>

        <h4>üìù Sample Text to Read (1-3 minutes):</h4>
        <div style="background: white; padding: 10px; border-left: 4px solid #ff8800;">
            <p><em>"Hello! My name is [your name]. I'm testing the voice cloning system today.
            The weather outside is quite nice, isn't it? I'm curious to hear how my artificial voice will sound.

            Let me read some varied sentences now. Are you enjoying this demo? I hope the quality is good enough.
            Sometimes I speak quickly, and sometimes I speak more slowly. I can also express different emotions -
            excitement, concern, happiness, and curiosity.

            This technology is truly fascinating. In the future, we might be able to preserve our voices forever.
            Thank you for listening to this voice sample. I hope it works well for the cloning process!"</em></p>
        </div>

        <h4>‚ö†Ô∏è ElevenLabs Requirements:</h4>
        <ul>
            <li>Minimum 1 minute of clear speech</li>
            <li>Maximum file size: 10MB</li>
            <li>Supported formats: MP3, WAV</li>
            <li>Single speaker only</li>
        </ul>
    </div>

    <script>
        let mediaRecorder;
        let audioChunks = [];
        let audioBlob;
        let startTime;
        let timerInterval;

        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const playBtn = document.getElementById('playBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const status = document.getElementById('status');
        const timer = document.getElementById('timer');
        const audioPlayer = document.getElementById('audioPlayer');

        startBtn.addEventListener('click', startRecording);
        stopBtn.addEventListener('click', stopRecording);
        playBtn.addEventListener('click', playAudio);
        downloadBtn.addEventListener('click', downloadAudio);

        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            // Change color based on duration
            if (elapsed < 60) {
                timer.style.color = '#ff4444'; // Red - too short
                status.textContent = 'üî¥ Recording... Need at least 1 minute for good cloning';
            } else if (elapsed < 180) {
                timer.style.color = '#ff8800'; // Orange - good duration
                status.textContent = 'üü† Recording... Good duration for voice cloning';
            } else {
                timer.style.color = '#44ff44'; // Green - excellent duration
                status.textContent = 'üü¢ Recording... Excellent duration for voice cloning';
            }
        }

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    audio: {
                        sampleRate: 44100,
                        channelCount: 1,
                        volume: 1.0
                    }
                });

                mediaRecorder = new MediaRecorder(stream, {
                    mimeType: 'audio/webm;codecs=opus'
                });

                audioChunks = [];
                startTime = Date.now();

                mediaRecorder.ondataavailable = event => {
                    audioChunks.push(event.data);
                };

                mediaRecorder.onstop = () => {
                    clearInterval(timerInterval);
                    audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    const audioUrl = URL.createObjectURL(audioBlob);
                    audioPlayer.src = audioUrl;
                    audioPlayer.style.display = 'block';

                    playBtn.disabled = false;
                    downloadBtn.disabled = false;

                    const duration = Math.floor((Date.now() - startTime) / 1000);
                    if (duration < 60) {
                        status.textContent = `‚ö†Ô∏è Recording complete! Duration: ${duration}s - Consider recording longer (60s+ recommended)`;
                        status.style.backgroundColor = '#ffeeee';
                    } else {
                        status.textContent = `‚úÖ Recording complete! Duration: ${duration}s - Perfect for voice cloning!`;
                        status.style.backgroundColor = '#eeffee';
                    }
                };

                mediaRecorder.start();

                startBtn.disabled = true;
                stopBtn.disabled = false;
                status.textContent = 'üî¥ Recording... Speak clearly into the microphone';
                status.className = 'status recording';

                timerInterval = setInterval(updateTimer, 1000);
                updateTimer();

            } catch (err) {
                console.error('Recording error:', err);
                status.textContent = 'Error: Could not access microphone';
            }
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
            }

            startBtn.disabled = false;
            stopBtn.disabled = true;
            clearInterval(timerInterval);
        }

        function playAudio() {
            audioPlayer.play();
        }

        function downloadAudio() {
            if (audioBlob) {
                const url = URL.createObjectURL(audioBlob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = 'voice-sample-for-cloning.webm';
                document.body.appendChild(a);
                a.click();

                // Create a second download with .wav extension for compatibility
                setTimeout(() => {
                    const a2 = document.createElement('a');
                    a2.style.display = 'none';
                    a2.href = url;
                    a2.download = 'voice-sample-for-cloning.wav';
                    document.body.appendChild(a2);
                    a2.click();
                    window.URL.revokeObjectURL(url);
                }, 100);

                status.textContent = '‚úÖ Audio downloaded! Use this file for voice cloning test.';
            }
        }
    </script>
</body>
</html>